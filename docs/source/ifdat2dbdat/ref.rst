Κανόνες μετατροπής πινάκων REF του IFDAT σε πίνακες REF του DAT
===============================================================

Οι παρακάτω κανόνες δίνονται με τρόπο ώστε να είναι σαφής η περιγραφή τους.  Η
υλοποίηση των κανόνων μπορεί να διαφέρει από τη σειρά και τον τρόπο που
παραουσιάζονται οι κανόνες αφού κάποιοι κανόνες που παραουσιάζονται σειριακά
μπορούν να υλοποιηθούν και παράλληλα.

IFDAT:REF.RA
------------

ΒΑΣΙΚΕΣ ΜΕΤΡΗΣΕΙΣ
~~~~~~~~~~~~~~~~~

Διαγράφονται οι μετρήσεις LEI_ID, TAX_ID, NBR_ID και αν το αποτέλεσμα περιέχει συμπληρωμένες *μετρήσεις* μεταφέρεται στον πίνακα DAT:REF.ORG.


ΑΝΑΓΝΩΡΙΣΤΙΚΟΙ ΚΩΔΙΚΟΙ
~~~~~~~~~~~~~~~~~~~~~~

Διατηρείται η διάσταση ID και οι μέτρησεις LEI_ID, TAX_ID, NBR_ID. Αν στις τιμές των μετρήσεων δεν περιλαμβάνονται συμπληρωμένες τιμές η επεξεργασία σταματάει.  Αν υπάρχουν συμπληρωμένες μετρήσειες και δεν είναι ίσες με την τιμή της αρχικοποίησης τότε στην τιμή προστίθεται το πρόθεμα 'L', 'T', 'B' για τις μετρήσεις LEI_ID, TAX_ID, NBR_ID αντίστοιχα.  

Η παρακάτω διαδικασία ακολουθείται για κάθε μέτρηση LEI_ID, TAX_ID, NBR_ID.  Για τη διευκόλυνση της επεξήγησης το πρόθεμα του αναγνωριστικού κωδικού το ορίζουμε ως P και το όνομα της μέτρησης ως OID.

ΑΡΧΙΚΟΠΟΙΗΣΗ
""""""""""""
Για τη OID διατηρούνται οι τιμές που είναι ίσες με την τιμή της αρχικοποίησης.  Αν δεν υπάρχουν τέτοιες τιμές ολοκληρώνεται η διαδικασία.  Από τον πίνακα REF.ORG_ALIAS της BED αντλούνται τα στοιχεία με WHERE={RID:ID}.  Διατηρούνται τα στοιχεία με τιμές όπου το LID ξεκινάει με το πρόθεμα P.  Αν δεν υπάρχουν παρατηρήσεις ολοκληρώνεται η διαδικασία.  Στη μεταβλητή ALIAS_OF εισάγεται η τιμή της αρχικοποίησης και διατηρούνται οι μεταβλητές LID, RID, ALIAS_OF και μεταφέρονται στο πίνακα DAT.ORG_ALIAS.

ΕΙΣΑΓΩΓΗ
""""""""
Για τη OID διατηρούνται οι συμπληρωμένες τιμές που δεν είναι ίσες με την τιμή της αρχικοποίησης.  Αν δεν υπάρχουν τέτοιες τιμές ολοκληρώνεται η διαδικασία.  Από τον πίνακα REF.ORG_ALIAS της BED αντλούνται τα auth στοιχεία με WHERE={LID:OID,ALIAS_OF:'T'}.  Αν στα auth στοιχεία ύπαρχει διασύνδεση και είναι διαφορετική από τα εισερχόμενα στοιχεία τότε εισάγεται απορριπτικό σφάλμα στο ΑΠΑ.  Αν όχι διατηρούνται η μεταβλητή OID μετονομάζεται σε LID, η μεταβλητή RID μετονομάζεται σε ID και προστίθεται η τιμή ALIAS_OF='T' και μεταφέρονται στον πίνακα DAT.ORG_ALIAS. 


IFDAT:REF.RA_DYNMC
------------------
Μεταφέρεται αυτούσιος στον πίνακα DAT:REF.ORG


IFDAT:REF.FND
-------------
Ακολουθούνται οι οδηγίες του πίνακα REF.RA 


IFDAT:REF.FND_DYNMC
-------------------

ΒΑΣΙΚΕΣ ΜΕΤΡΗΣΕΙΣ
~~~~~~~~~~~~~~~~~

Διαγράφονται οι μεταβλητές RPRTD_BY, MNGD_BY, UNDR_UMBRLL_BY. Μετονομάζονται οι μεταβλητές LGL_TYP, INVSTMNT_PLCY, EQTY_TYP, DSTRBTN_PLCY, INVSTR_TYP, GRN_TYP, STRTGY, GGRPHCL_FCS, BND_FCS, RL_ESTT_TYP προσθέτοντας το πρόθεμα FND_.  Το αποτέλεσμα μεταφέρεται στον πίνακα DAT:REF.ORG_DYNMC.

ΜΕΤΡΗΣΕΙΣ ΣΧΕΣΕΩΝ
~~~~~~~~~~~~~~~~~
Η παρακάτω διαδικασία ακολουθείται για κάθε μεταβλητή RPRTD_BY, MNGD_BY, UNDR_UMBRLL_BY και οι διαστάσεις (ID, VLD_FRM, VLD_T) πάντα παραμένουν.  Για τη διευκόλυνση της επεξήγησης τη μεταβλητή της σχέσης την ονομάζουμε LINK_ID.  Οι μεταβλητές αυτές αντίστοιχα στον πίνακα DAT:REF.ORG2ORG είναι οι IFDAT_RPRTR_OF, MNGMNT_OF, UMBRELL_OF και για διευκόλυνση θα την ονομάσουμε DAT_LINK_ID.

Διατηρείται η μεταβλητή LINK_ID.  Αν το LINK_ID αφορά τη μεταβλητή RPRTD_BY τότε αντλείται η auth τιμή από το πίνακα REF.ORG2ORG της BED με WHERE={LID:RPRTD_BY, RID:ID, IFDAT_RPRTR_OF:'T'} και αν στα αποτελέσματα για το ίδιο διάστημα της υποβολής άλλος RPRTD_BY τότε εισάγεται απορριπτικό σφάλμα στο ΑΠΑ.Αν το RPRTD_BY είναι διαφορετικό από το PARTNER και το VLD_T δεν είναι κενό τότε εισάγεται απορριπτικό σφάλμα στο ΑΠΑ.

ΑΡΧΙΚΟΠΟΙΗΣΗ
""""""""""""
Αν η τιμή της LINK_ID είναι ίση με την τιμή της αρχικοποίησης τότε αντλούνται τα στοιχεία του πίνακα REF.ORG2ORG της BED με WHERE={RID:ID} για τη μεταβλητή DAT_LINK_ID και για τα LID που αντλείται για κάθε εισερχόμενο ID δημιουργούνται παρατηρήσεις αρχικοποίησης όπου η κάθε παρατήρηση αποτελείται από το LID (από τη BED), το RID(το ID), VLD_FRM και VLD_T από το εισερχόμενο αρχείο η τιμή του DAT_LINK_ID είναι η τιμή της αρχικοποίησης.  Οι παρατηρήσεις αυτές μεταφέρονται στον πίνακα DAT:REF.ORG2ORG.

ΕΙΣΑΓΩΓΗ
""""""""
Αν η τιμή της LINΚ_ID είναι συμπληρωμένη και δεν ισούται με την τιμή της αρχικοποίησης τότε δημιουργούνται παρατηρήσεις με LID=LINK_ID, RID=ID, VLD_FRM=VLD_FRM, VLD_T=VLD_T, DAT_LINK_ID='T' και μεταφέρονται στο πίνακα DAT:REF.ORG2ORG.


IFDAT:REF.SELF_DBT
------------------

Διατηρούνται οι μετρήσεις DT_BRTH, DT_CLS, ORGNL_MTRTY, UNDRLYNG, RSTRCTRD_T, RSTRCTRD_FRM και αν έχουν συμπληρωμένες τιμές μεταφέρονται μαζί με τη διάσταση ID στον πίνακα DAT:REF.DBT

Διαγράφονται οι μετρήσεις DT_BRTH, DT_CLS, ORGNL_MTRTY, UNDRLYNG, RSTRCTRD_T, RSTRCTRD_FRM και αν έχουν συμπληρωμένες τιμές μεταφέρονται μαζί με τη διάσταση ID στον πίνακα DAT:REF.DBT_DYNMC


IFDAT:REF.SELF_DBT_DYNMC
------------------------

Διαγράφεται η μέτρηση ISSD_BY και αν υπάρχουν συμπληρωμένες παρατηρήσεις μεταφέρονται στον πίνακα DAT:REF.DBT_DYNMC

Διατηρείται η μέτρηση ISSD_BY και αν είναι συμπληρωμένη μετονομάζεται σε LID, το ID μετονομάζεται σε RID και προσθέτεται ISSR_OF = 'T' και όλες οι μεταβλητές μεταφέρονται στο πίνακα DAT:REF.ORG2DBT.  Αρχικοποίηση δεν επιτρέπεται στη συγκεκριμένη μεταβλητή.


IFDAT:REF.SELF_DBT_OUTSTNDNG_CHNG
---------------------------------

Μεταφέρεται αυτούσιος στον πίνακα DAT:REF.DBT_OUTSTNDNG_CHNG 


IFDAT:REF.SELF_DBT_CPN
----------------------

Μεταφέρεται αυτούσιος στον πίνακα DAT:REF.DBT_CPN

IFDAT:REF.SELF_SHR
------------------

Διατηρούνται οι μετρήσεις DT_BRTH, DT_CLS, RSTRCTRD_T και αν έχουν συμπληρωμένες τιμές μεταφέρονται μαζί με τη διάσταση ID στον πίνακα DAT:REF.SHR

Διαγράφονται οι μετρήσεις DT_BRTH, DT_CLS, RSTRCTRD_T και αν έχουν συμπληρωμένες τιμές μεταφέρονται μαζί με τη διάσταση ID στον πίνακα DAT:REF.SHR_DYNMC


IFDAT:REF.SELF_DBT_DYNMC
------------------------

Διαγράφεται η μέτρηση ISSD_BY και αν υπάρχουν συμπληρωμένες παρατηρήσεις μεταφέρονται στον πίνακα DAT:REF.SHR_DYNMC

Διατηρείται η μέτρηση ISSD_BY και αν είναι συμπληρωμένη μετονομάζεται σε LID, το ID μετονομάζεται σε RID και προσθέτεται ISSR_OF = 'T' και όλες οι μεταβλητές μεταφέρονται στο πίνακα DAT:REF.ORG2SHR.  Αρχικοποίηση δεν επιτρέπεται στη συγκεκριμένη μεταβλητή.


IFDAT:REF.SELF_SHR_DVDND
------------------------

Μεταφέρεται αυτούσιος στον πίνακα DAT:REF.SHR_DVDND


IFDAT:REF.SELF_SHR_SPLT
-----------------------

Μεταφέρεται αυτούσιος στον πίνακα DAT:REF.SHR_SPLT

IFDAT:REF.CNTRPRTY
------------------

Μεταφέρεται αυτούσιος στον πίνακα DAT:REF.ORG_DYNMC


IFDAT:REF.DPST
--------------

Μεταφέρεται αυτούσιος στον πίνακα DAT:REF.DPST

IFDAT:REF.LN
------------

Μεταφέρεται αυτούσιος στον πίνακα DAT:REF.LN


IFDAT:REF.DBT
-------------

Διαγράφεται η μέτρηση ISSD_BY και αν υπάρχουν συμπληρωμένες παρατηρήσεις μεταφέρονται στον πίνακα DAT:REF.DBT_DYNMC

Διατηρείται η μέτρηση ISSD_BY και αν είναι συμπληρωμένη μετονομάζεται σε LID, το ID μετονομάζεται σε RID και προσθέτεται ISSR_OF = 'T' και όλες οι μεταβλητές μεταφέρονται στο πίνακα DAT:REF.ORG2DBT.  Αρχικοποίηση δεν επιτρέπεται στη συγκεκριμένη μεταβλητή.

IFDAT:REF.SHR
-------------

Διαγράφεται η μέτρηση ISSD_BY και αν υπάρχουν συμπληρωμένες παρατηρήσεις μεταφέρονται στον πίνακα DAT:REF.SHR_DYNMC

Διατηρείται η μέτρηση ISSD_BY και αν είναι συμπληρωμένη μετονομάζεται σε LID, το ID μετονομάζεται σε RID και προσθέτεται ISSR_OF = 'T' και όλες οι μεταβλητές μεταφέρονται στο πίνακα DAT:REF.ORG2SHR.  Αρχικοποίηση δεν επιτρέπεται στη συγκεκριμένη μεταβλητή.

IFDAT:REF.DER
-------------

Μεταφέρεται αυτούσιος στον πίνακα DAT:REF.DER


IFDAT:REF.DRGTN
---------------
H μεταβλητή DRGTN_TYPE μετονομάζεται σε IFDAT_DRGTN_TYPE και ο πίνακας μεταφέρεται στο DAT:REF.DRGTN
