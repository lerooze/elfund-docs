Κανόνες μετάβασης από τη DAT στη BED
====================================


ΚΑΝΟΝΑΣ 1 - Χειρισμός STTS Attribute
------------------------------------

Για κάθε πίνακα εάν δεν υπάρχει το STATUS ATTRIBUTE για κάθε μεταβλητή με τιμή
τότε συμπληρώνεται αυτόματα η τιμή Α για το STATUS ATTRIBUTE εκτός εάν έχουν
συμπληρωθεί οι ειδικές τιμές αρχικοποίησης. Πιο αναλυτικά:

+--------+-----------------------+------------------+---+-----------------------+------------------+
|        | Measure               | STATUS ATTRIBUTE | → | Measure               | STATUS ATTRIBUTE |
+========+=======================+==================+===+=======================+==================+
| Case 1 | Κανονικά Συμπληρωμένο | ΚΕΝΟ             | → | Κανονικά Συμπληρωμένο | Α                |
+--------+-----------------------+------------------+---+-----------------------+------------------+
| Case 2 | Reset Τιμή            | ΚΕΝΟ             | → | Reset Τιμή            | .                |
+--------+-----------------------+------------------+---+-----------------------+------------------+

Οι τιμές αρχικοποίησης ανά είδος μεταβλητή είναι οι ακόλουθες:

+------------------+-------------+
| Τύπος Μεταβλητής | Reset Τιμή  |
+==================+=============+
| DATEΤΙΜΕ         | 1700-01-01  |
+------------------+-------------+
| ΙΝΤ              | 999999999   |
+------------------+-------------+
| FLOAT            | 999999999.0 |
+------------------+-------------+
| Υπόλοιπες        | .           |
+------------------+-------------+


ΚΑΝΟΝΑΣ 2 - ΣΥΜΠΛΗΡΩΣΗ ΚΕΝΩΝ ΔΙΑΣΤΑΣΕΩΝ VLD_FRM, VLD_T
------------------------------------------------------

Εάν ο πίνακας περιλαμβάνει τη διάσταση VLD_FRM και τη διάσταση VLD_T ισχύει ότι:

+--------+------------+------------+---+------------------------------+-----------------------------+
|        | VLD_FRM    | VLD_T      | → | VLD_FRM                      | VLD_T                       |
+========+============+============+===+==============================+=============================+
| Case 1 | ΚΕΝΟ       | YYYY-MM-DD | → | MIN_DATE που δέχεται η Βάση  | YYYY-MM-DD                  |
+--------+------------+------------+---+------------------------------+-----------------------------+
| Case 2 | ΚΕΝΟ       | ΚΕΝΟ       | → |  MIN_DATE που δέχεται η Βάση | ΜΑΧ_DATE που δέχεται η Βάση |
+--------+------------+------------+---+------------------------------+-----------------------------+
| Case 3 | EEEE-MM-HH | ΚΕΝΟ       | → | EEEE-MM-HH                   | ΜΑΧ_DATE που δέχεται η Βάση |
+--------+------------+------------+---+------------------------------+-----------------------------+


ΚΑΝΟΝΑΣ 2A - ΣΥΜΠΛΗΡΩΣΗ ΚΕΝΩΝ MEASURES με DATETIME FORMAT
---------------------------------------------------------
DT_BRTH... MINDATE
DT_CLS... MAXDATE


ΚΑΝΟΝΑΣ 3 - ΑΝΤΙΚΑΤΑΣΤΑΣΗ ALIAS ΑΝΑΓΝΩΡΙΣΤΙΚΩΝ ΚΩΔΙΚΩΝ
------------------------------------------------------

Πρώτα επεξεργάζονται και εισάγονται στη βάση οι «alias» πίνακες (REF.ORG_ALIAS,
REF.SHR_ALIAS, REF.DBT_ALIAS, REF.DER_ALIAS) και ύστερα οι υπόλοιποι. Στους
«alias» πίνακες δεν γίνεται αντικατάσταση αναγνωριστικών κωδικών.

Στους υπόλοιπους πίνακες η αντικατάσταση των αναγνωριστικών κωδικών γίνεται με βάση το είδος της τιμής των αναγνωριστικών κωδικών:

ORG_ID
    Αν το είδος του πεδίου είναι ORG_ID τότε γίνεται αναζήτητση στη BED ως εξής όπου ORGS είναι οι τιμές του πεδίου:

    Επέστρεψε μου RID, ALS_OF από τον πίνακα ORG_ALIAS 

    WHERE

      LID = ORGS
      SRC_TYP = AUTH
      SRC_ORG = AUTH
      SRC_USR = AUTH
      TIMESTAMP = MAX(TIMESTAMP)

    Για τις παρατηρήσεις που ALS_OF = T αντικατέστησε τις τιμές του πεδίου με το RID, αλλιώς άφησε την ήδη υπάρχουσα τιμή.

    Παράδειγμα:

    Εισερχόμενος πίνακας DAT:REF.ORG_DYNMC

    +---------+---------+---------+--------+------------+------------+----+------+
    | SRC_TYP | SRC_ORG | SRC_USR | ID     | VLD_FRM    | VLD_T      | NM | SCTR |
    +=========+=========+=========+========+============+============+====+======+
    | CDR     | EGR0    | auser   | BGRXXX |            |            | A  |      |
    +---------+---------+---------+--------+------------+------------+----+------+
    | CDR     | EGR0    | auser   | BGRXXX | 2000-01-01 | 2010-11-24 | B  | S128 |
    +---------+---------+---------+--------+------------+------------+----+------+
    | CDR     | EGR0    | auser   | BGRXXX | 2009-01-25 |            | C  |      |
    +---------+---------+---------+--------+------------+------------+----+------+
    | CDR     | EGR0    | auser   | EGR2   | 2000-01-01 | 2010-01-01 | Z  |      |
    +---------+---------+---------+--------+------------+------------+----+------+
    | CDR     | EGR0    | auser   | EGR2   | 2009-01-01 | 2020-01-01 |    | S127 |
    +---------+---------+---------+--------+------------+------------+----+------+
    | CDR     | EGR0    | auser   | EGR2   | 2022-01-01 | 2025-01-01 | Υ  | S122 |
    +---------+---------+---------+--------+------------+------------+----+------+

    Στοιχεία από BED:REF.ORG_ALIAS

    +---------+---------+---------+--------+------+----------+
    | SRC_TYP | SRC_ORG | SRC_USR | LID    | RID  | ALIAS_OF |
    +=========+=========+=========+========+======+==========+
    | AUTH    | AUTH    | AUTH    | BGRXXX | EGR1 | T        |
    +---------+---------+---------+--------+------+----------+

    Εισερχόμενος πίνακας DAT:REF.ORG μετά την αντικατάσταση των ALIAS κωδικών 

    +---------+---------+---------+------+------------+------------+----+------+
    | SRC_TYP | SRC_ORG | SRC_USR | ID   | VLD_FRM    | VLD_T      | NM | SCTR |
    +=========+=========+=========+======+============+============+====+======+
    | CDR     | EGR0    | auser   | EGR1 |            |            | A  |      |
    +---------+---------+---------+------+------------+------------+----+------+
    | CDR     | EGR0    | auser   | EGR1 | 2000-01-01 | 2010-11-24 | B  | S128 |
    +---------+---------+---------+------+------------+------------+----+------+
    | CDR     | EGR0    | auser   | EGR1 | 2009-01-25 |            | C  |      |
    +---------+---------+---------+------+------------+------------+----+------+
    | CDR     | EGR0    | auser   | EGR2 | 2000-01-01 | 2010-01-01 | Z  |      |
    +---------+---------+---------+------+------------+------------+----+------+
    | CDR     | EGR0    | auser   | EGR2 | 2009-01-01 | 2020-01-01 |    | S127 |
    +---------+---------+---------+------+------------+------------+----+------+
    | CDR     | EGR0    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Υ  | S122 |
    +---------+---------+---------+------+------------+------------+----+------+


DBT_ID
    Αν το είδος του πεδίου είναι DBT_ID τότε γίνεται αναζήτητση στη BED ως εξής όπου DBTS είναι οι τιμές του πεδίου:

    Επέστρεψε μου RID, ALS_OF από τον πίνακα DBT_ALIAS 

    WHERE

      LID = DBTS
      SRC_TYP = AUTH
      SRC_ORG = AUTH
      SRC_USR = AUTH
      TIMESTAMP = MAX(TIMESTAMP)

    Για τις παρατηρήσεις που ALS_OF = T αντικατέστησε τις τιμές του πεδίου με το RID, αλλιώς άφησε την ήδη υπάρχουσα τιμή.

SHR_ID
    Αν το είδος του πεδίου είναι SHR_ID τότε γίνεται αναζήτητση στη BED ως εξής όπου SHRS είναι οι τιμές του πεδίου:

    Επέστρεψε μου RID, ALS_OF από τον πίνακα SHR_ALIAS 

    WHERE

      LID = SHRS
      SRC_TYP = AUTH
      SRC_ORG = AUTH
      SRC_USR = AUTH
      TIMESTAMP = MAX(TIMESTAMP)

    Για τις παρατηρήσεις που ALS_OF = T αντικατέστησε τις τιμές του πεδίου με το RID, αλλιώς άφησε την ήδη υπάρχουσα τιμή.

DER_ID
    Αν το είδος του πεδίου είναι DER_ID τότε γίνεται αναζήτητση στη BED ως εξής όπου DERS είναι οι τιμές του πεδίου:

    Επέστρεψε μου RID, ALS_OF από τον πίνακα DER_ALIAS 

    WHERE

      LID = DERS
      SRC_TYP = AUTH
      SRC_ORG = AUTH
      SRC_USR = AUTH
      TIMESTAMP = MAX(TIMESTAMP)

    Για τις παρατηρήσεις που ALS_OF = T αντικατέστησε τις τιμές του πεδίου με το RID, αλλιώς άφησε την ήδη υπάρχουσα τιμή.


ΚΑΝΟΝΑΣ 4 - ΑΝΑΚΤΗΣΗ ΥΦΙΣΤΑΜΕΝΩΝ ΣΤΟΙΧΕΙΩΝ ΣΤΗ BED
--------------------------------------------------

Για κάθε εισερχόμενο πίνακα DAT ανακτάται από την BED, η πιο πρόσφατη έκδοση όλων των διαθέσιμων πηγών.

Τα ID που μας ενδιαφέρουν τα εντοπίζουμε από τον υποβαλλόμενο πίνακα DAT με βάση τις παρακάτω περιπτώσεις.


ΠΕΡΙΠΤΩΣΗ 1 - ΠΙΝΑΚΕΣ ΜΕ ΕΝΑ ΑΝΑΓΝΩΡΙΣΤΙΚΟ ΚΩΔΙΚΟ ΣΤΙΣ ΔΙΑΣΤΑΣΕΙΣ
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Αν ο πίνακας έχει ένα μόνο αναγνωριστικό κωδικό στις διαστάσεις, γίνεται query στον αντίστοιχο πίνακα της BED με ID το ID του εισερχόμενου/υποβαλλόμενου πίνακα και επιστρέφονται όλες οι εγγραφές της πιο πρόσφατης έκδοσης.


Παράδειγμα - Πίνακας DAT:REF.ORG_DYNMC
""""""""""""""""""""""""""""""""""""""

Για τα IDS={EGR1,EGR2} από το εισερχόμενο αντλούμαι την τελευταία έκδοση από τη BED:REF.ORG_DYNMC:


  +---------+---------+---------+------+------------+------------+----+------+
  | SRC_TYP | SRC_ORG | SRC_USR | ID   | VLD_FRM    | VLD_T      | NM | SCTR |
  +=========+=========+=========+======+============+============+====+======+
  | AUTH    | AUTH    | AUTH    | EGR1 | MINDATE    | MAXDATE    | D  |      |
  +---------+---------+---------+------+------------+------------+----+------+
  | AUTH    | AUTH    | buser   | EGR1 | MINDATE    | MAXDATE    | D  |      |
  +---------+---------+---------+------+------------+------------+----+------+
  | AUTH    | AUTH    | auser   | EGR1 | MINDATE    | MAXDATE    | E  |      |
  +---------+---------+---------+------+------------+------------+----+------+
  | AUTH    | EGR0    | AUTH    | EGR1 | MINDATE    | MAXDATE    | D  |      |
  +---------+---------+---------+------+------------+------------+----+------+
  | AUTH    | EGR0    | buser   | EGR1 | MINDATE    | MAXDATE    | D  |      |
  +---------+---------+---------+------+------------+------------+----+------+
  | AUTH    | EGR0    | auser   | EGR1 | MINDATE    | MAXDATE    | E  |      |
  +---------+---------+---------+------+------------+------------+----+------+
  | CDR     | AUTH    | AUTH    | EGR1 | MINDATE    | MAXDATE    | D  |      |
  +---------+---------+---------+------+------------+------------+----+------+
  | CDR     | AUTH    | buser   | EGR1 | MINDATE    | MAXDATE    | D  |      |
  +---------+---------+---------+------+------------+------------+----+------+
  | CDR     | AUTH    | auser   | EGR1 | MINDATE    | MAXDATE    | E  |      |
  +---------+---------+---------+------+------------+------------+----+------+
  | CDR     | EGR0    | AUTH    | EGR1 | MINDATE    | MAXDATE    | D  |      |
  +---------+---------+---------+------+------------+------------+----+------+
  | CDR     | EGR0    | buser   | EGR1 | MINDATE    | MAXDATE    | D  |      |
  +---------+---------+---------+------+------------+------------+----+------+
  | CDR     | EGR0    | auser   | EGR1 | MINDATE    | MAXDATE    | E  |      |
  +---------+---------+---------+------+------------+------------+----+------+
  | AUTH    | AUTH    | AUTH    | EGR2 | MINDATE    | 2013-01-01 | Y  | S125 |
  +---------+---------+---------+------+------------+------------+----+------+
  | AUTH    | AUTH    | AUTH    | EGR2 | 2013-01-01 | MAXDATE    | Y  | S127 |
  +---------+---------+---------+------+------------+------------+----+------+
  | AUTH    | AUTH    | auser   | EGR2 | MINDATE    | 2013-01-01 | Y  | S125 |
  +---------+---------+---------+------+------------+------------+----+------+
  | AUTH    | AUTH    | auser   | EGR2 | 2013-01-01 | MAXDATE    | Y  | S127 |
  +---------+---------+---------+------+------------+------------+----+------+
  | AUTH    | EGR0    | AUTH    | EGR2 | MINDATE    | 2013-01-01 | Y  | S125 |
  +---------+---------+---------+------+------------+------------+----+------+
  | AUTH    | EGR0    | AUTH    | EGR2 | 2013-01-01 | MAXDATE    | Y  | S127 |
  +---------+---------+---------+------+------------+------------+----+------+
  | AUTH    | EGR0    | auser   | EGR2 | MINDATE    | 2013-01-01 | Y  | S125 |
  +---------+---------+---------+------+------------+------------+----+------+
  | AUTH    | EGR0    | auser   | EGR2 | 2013-01-01 | MAXDATE    | Y  | S127 |
  +---------+---------+---------+------+------------+------------+----+------+
  | CDR     | AUTH    | AUTH    | EGR2 | MINDATE    | 2013-01-01 | Y  | S125 |
  +---------+---------+---------+------+------------+------------+----+------+
  | CDR     | AUTH    | AUTH    | EGR2 | 2013-01-01 | MAXDATE    | Y  | S127 |
  +---------+---------+---------+------+------------+------------+----+------+
  | CDR     | AUTH    | auser   | EGR2 | MINDATE    | 2013-01-01 | Y  | S125 |
  +---------+---------+---------+------+------------+------------+----+------+
  | CDR     | AUTH    | auser   | EGR2 | 2013-01-01 | MAXDATE    | Y  | S127 |
  +---------+---------+---------+------+------------+------------+----+------+
  | CDR     | EGR0    | AUTH    | EGR2 | MINDATE    | 2013-01-01 | Y  | S125 |
  +---------+---------+---------+------+------------+------------+----+------+
  | CDR     | EGR0    | AUTH    | EGR2 | 2013-01-01 | MAXDATE    | Y  | S127 |
  +---------+---------+---------+------+------------+------------+----+------+
  | CDR     | EGR0    | auser   | EGR2 | MINDATE    | 2013-01-01 | Y  | S125 |
  +---------+---------+---------+------+------------+------------+----+------+
  | CDR     | EGR0    | auser   | EGR2 | 2013-01-01 | MAXDATE    | Y  | S127 |
  +---------+---------+---------+------+------------+------------+----+------+

Query στη BED στον πίνακα REF.ORG_DYNMC

Επέστρεψε μου όλες τις μεταβλητές 
  WHERE
    BED.REF.ORG_DYNMC.ID= DAT:REF.ORG_DYNMC.ID
    Timestamp = MAX(Timestamp)


ΠΕΡΙΠΤΩΣΗ 2 - ΠΙΝΑΚΕΣ ΜΕ ΠΑΝΩ ΑΠΟ ΕΝΑ ΑΝΑΓΝΩΡΙΣΤΙΚΟ ΚΩΔΙΚΟ ΣΤΙΣ ΔΙΑΣΤΑΣΕΙΣ
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Εάν ο πίνακας στις διαστάσεις του περιλαμβάνει άνω του ενός αναγνωριστικού κωδικού, τότε το Query στην BED γίνεται με βάση το πρώτο ID. Για παράδειγμα εάν στις διαστάσεις περιέχονται οι διαστάσεις LID, RID επιλέγεται το σύνολο της πληροφόρησης για την διάσταση LID.


ΚΑΝΟΝΑΣ 5: ΧΕΙΡΙΣΜΟΣ ΚΕΝΟΥ STTS
-------------------------------

Για τα επιλεγμένα υφιστάμενα στοιχεία του κανόνα 5 , για κάθε μεταβλητή όπου το STATUS ATTRIBUTE (Measure.STATUS) είναι ίσο με None η τιμή της αντίστοιχης μεταβλητής (Measure) αντικαθίσταται με τιμή None που δείχνει ότι η τιμή δεν είναι συμπληρωμένη.


ΚΑΝΟΝΑΣ 6: Διακριτικοποίηση, κάλυψη, επέκταση, διαγραφή διπλοεγγραφών εισερχόμενου πίνακα 
------------------------------------------------------------------------------------------

Αρχική υποβολή επικαλυπτόμενων εγγραφών:

+---------+---------+---------+------+------------+------------+----+------+
| SRC_TYP | SRC_ORG | SRC_USR | ID   | VLD_FRM    | VLD_T      | NM | SCTR |
+=========+=========+=========+======+============+============+====+======+
| CDR     | EGR0    | auser   | EGR1 | MINDATE    | MAXDATE    | A  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2000-01-01 | 2010-11-24 | B  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2009-01-25 | MAXDATE    | C  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2000-01-01 | 2010-01-01 | Z  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2009-01-01 | 2020-01-01 |    | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Υ  | S122 |
+---------+---------+---------+------+------------+------------+----+------+

Διακριτικοποίηση χρονικών διαστημάτων:

+---------+---------+---------+------+------------+------------+----+------+
| SRC_TYP | SRC_ORG | SRC_USR | ID   | VLD_FRM    | VLD_T      | NM | SCTR |
+=========+=========+=========+======+============+============+====+======+
| CDR     | EGR0    | auser   | EGR1 | MINDATE    | 2000-01-01 |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2000-01-01 | 2009-01-25 |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2009-01-25 | 2010-11-24 |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2010-11-24 | MAXDATE    |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2000-01-01 | 2009-01-01 |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2009-01-01 | 2010-01-01 |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2010-01-01 | 2020-01-01 |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2022-01-01 | 2025-01-01 |    |      |
+---------+---------+---------+------+------------+------------+----+------+

Κάλυψη με διατήρηση της πιο προσφατης εγγραφής (από κάτω προς τα πάνω) αν δεν είναι κενή:

+---------+---------+---------+------+------------+------------+----+------+
| SRC_TYP | SRC_ORG | SRC_USR | ID   | VLD_FRM    | VLD_T      | NM | SCTR |
+=========+=========+=========+======+============+============+====+======+
| CDR     | EGR0    | auser   | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2009-01-25 | 2010-11-24 | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2010-11-24 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2000-01-01 | 2009-01-01 | Z  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2010-01-01 | 2020-01-01 |    | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+

Επέκταση διαστημάτων με κενές μεταβλητές:

+---------+---------+---------+------+------------+------------+----+------+
| SRC_TYP | SRC_ORG | SRC_USR | ID   | VLD_FRM    | VLD_T      | NM | SCTR |
+=========+=========+=========+======+============+============+====+======+
| CDR     | EGR0    | auser   | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2009-01-25 | 2010-11-24 | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2010-11-24 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | MINDATE    | 2000-01-01 |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2000-01-01 | 2009-01-01 | Z  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2010-01-01 | 2020-01-01 |    | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2020-01-01 | 2022-01-01 |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2025-01-01 | MAXDATE    |    |      |
+---------+---------+---------+------+------------+------------+----+------+

Διαγραφή διπλοεγγραφών:

+---------+---------+---------+------+------------+------------+----+------+
| SRC_TYP | SRC_ORG | SRC_USR | ID   | VLD_FRM    | VLD_T      | NM | SCTR |
+=========+=========+=========+======+============+============+====+======+
| CDR     | EGR0    | auser   | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | MINDATE    | 2000-01-01 |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2000-01-01 | 2009-01-01 | Z  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2010-01-01 | 2020-01-01 |    | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2020-01-01 | 2022-01-01 |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2025-01-01 | MAXDATE    |    |      |
+---------+---------+---------+------+------------+------------+----+------+


ΚΑΝΟΝΑΣ 7: Ευθυγράμμιση χρονικών διαστημάτων ανά αναγνωριστικό κωδικό μεταξύ υφιστάμενου και νέου πίνακα και επαναδημιουργία πινάκων
------------------------------------------------------------------------------------------------------------------------------------

Από τα υφιστάμενα στοιχεία έχουμε τα παρακάτω χρονικά διαστήματα ανά ID:

+------+------------+------------+
| ID   | VLD_FRM    | VLD_T      |
+======+============+============+
| EGR1 | MINDATE    | MAXDATE    |
+------+------------+------------+
| EGR2 | MINDATE    | 2013-01-01 |
+------+------------+------------+
| EGR2 | 2013-01-01 | MAXDATE    |
+------+------------+------------+

Από το εισερχόμενα στοιχεία έχουμε τα παρακάτω χρονικά διαστήματα ανά ID:

+------+------------+------------+
| ID   | VLD_FRM    | VLD_T      |
+======+============+============+
| EGR1 | MINDATE    | 2000-01-01 |
+------+------------+------------+
| EGR1 | 2000-01-01 | 2009-01-25 |
+------+------------+------------+
| EGR1 | 2009-01-25 | MAXDATE    |
+------+------------+------------+
| EGR2 | MINDATE    | 2000-01-01 |
+------+------------+------------+
| EGR2 | 2000-01-01 | 2009-01-01 |
+------+------------+------------+
| EGR2 | 2009-01-01 | 2010-01-01 |
+------+------------+------------+
| EGR2 | 2010-01-01 | 2020-01-01 |
+------+------------+------------+
| EGR2 | 2020-01-01 | 2022-01-01 |
+------+------------+------------+
| EGR2 | 2022-01-01 | 2025-01-01 |
+------+------------+------------+
| EGR2 | 2025-01-01 | MAXDATE    |
+------+------------+------------+

Συνδυάζοντας τα χρονικά διαστήματα δημιουργούνται τα ακόλουθα διαστήματα:

+------+------------+------------+
| ID   | VLD_FRM    | VLD_T      |
+======+============+============+
| EGR1 | MINDATE    | 2000-01-01 |
+------+------------+------------+
| EGR1 | 2000-01-01 | 2009-01-25 |
+------+------------+------------+
| EGR1 | 2009-01-25 | MAXDATE    |
+------+------------+------------+
| EGR2 | MINDATE    | 2000-01-01 |
+------+------------+------------+
| EGR2 | 2000-01-01 | 2009-01-01 |
+------+------------+------------+
| EGR2 | 2009-01-01 | 2010-01-01 |
+------+------------+------------+
| EGR2 | 2010-01-01 | 2013-01-01 |
+------+------------+------------+
| EGR2 | 2013-01-01 | 2020-01-01 |
+------+------------+------------+
| EGR2 | 2020-01-01 | 2022-01-01 |
+------+------------+------------+
| EGR2 | 2022-01-01 | 2025-01-01 |
+------+------------+------------+
| EGR2 | 2025-01-01 | MAXDATE    |
+------+------------+------------+

Ο εισερχόμενος πίνακας με τα νέα διαστήματα και συμπλήρωση των κενών όπου είναι εφικτό:

+---------+---------+---------+------+------------+------------+----+------+
| SRC_TYP | SRC_ORG | SRC_USR | ID   | VLD_FRM    | VLD_T      | NM | SCTR |
+=========+=========+=========+======+============+============+====+======+
| CDR     | EGR0    | auser   | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | MINDATE    | 2000-01-01 |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2000-01-01 | 2009-01-01 | Z  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2010-01-01 | 2013-01-01 |    | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2013-01-01 | 2020-01-01 |    | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2020-01-01 | 2022-01-01 |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2025-01-01 | MAXDATE    |    |      |
+---------+---------+---------+------+------------+------------+----+------+

Τα υφιστάμενα στοιχεία όπως έχουν προσαρμοστεί με τα νέα διαστήματα και μετά τη
συμπλήρωση των κενών όπου είναι εφικτό:

+---------+---------+---------+------+------------+------------+----+------+
| SRC_TYP | SRC_ORG | SRC_USR | ID   | VLD_FRM    | VLD_T      | NM | SCTR |
+=========+=========+=========+======+============+============+====+======+
| AUTH    | AUTH    | AUTH    | EGR1 | MINDATE    | 2000-01-01 | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR1 | 2000-01-01 | 2009-01-25 | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR1 | 2009-01-25 | MAXDATE    | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | buser   | EGR1 | MINDATE    | 2000-01-01 | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | buser   | EGR1 | 2000-01-01 | 2009-01-25 | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | buser   | EGR1 | 2009-01-25 | MAXDATE    | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR1 | MINDATE    | 2000-01-01 | E  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR1 | 2000-01-01 | 2009-01-25 | E  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR1 | 2009-01-25 | MAXDATE    | E  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR1 | MINDATE    | 2000-01-01 | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR1 | 2000-01-01 | 2009-01-25 | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR1 | 2009-01-25 | MAXDATE    | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | buser   | EGR1 | MINDATE    | 2000-01-01 | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | buser   | EGR1 | 2000-01-01 | 2009-01-25 | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | buser   | EGR1 | 2009-01-25 | MAXDATE    | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR1 | MINDATE    | 2000-01-01 | E  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR1 | 2000-01-01 | 2009-01-25 | E  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR1 | 2009-01-25 | MAXDATE    | E  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR1 | MINDATE    | 2000-01-01 | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR1 | 2000-01-01 | 2009-01-25 | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR1 | 2009-01-25 | MAXDATE    | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | buser   | EGR1 | MINDATE    | 2000-01-01 | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | buser   | EGR1 | 2000-01-01 | 2009-01-25 | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | buser   | EGR1 | 2009-01-25 | MAXDATE    | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR1 | MINDATE    | 2000-01-01 | E  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR1 | 2000-01-01 | 2009-01-25 | E  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR1 | 2009-01-25 | MAXDATE    | E  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR1 | MINDATE    | 2000-01-01 | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR1 | 2000-01-01 | 2009-01-25 | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR1 | 2009-01-25 | MAXDATE    | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | buser   | EGR1 | MINDATE    | 2000-01-01 | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | buser   | EGR1 | 2000-01-01 | 2009-01-25 | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | buser   | EGR1 | 2009-01-25 | MAXDATE    | D  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | MINDATE    | 2000-01-01 | E  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2000-01-01 | 2009-01-25 | E  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2009-01-25 | MAXDATE    | E  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | MINDATE    | 2000-01-01 | Υ  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | 2000-01-01 | 2009-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | 2009-01-01 | 2010-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | 2010-01-01 | 2013-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | 2013-01-01 | 2020-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | 2020-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | MINDATE    | 2000-01-01 | Υ  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | 2000-01-01 | 2009-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | 2009-01-01 | 2010-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | 2010-01-01 | 2013-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | 2013-01-01 | 2020-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | 2020-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | MINDATE    | 2000-01-01 | Υ  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | 2000-01-01 | 2009-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | 2009-01-01 | 2010-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | 2010-01-01 | 2013-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | 2013-01-01 | 2020-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | 2020-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | MINDATE    | 2000-01-01 | Υ  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | 2000-01-01 | 2009-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | 2009-01-01 | 2010-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | 2010-01-01 | 2013-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | 2013-01-01 | 2020-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | 2020-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | MINDATE    | 2000-01-01 | Υ  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2000-01-01 | 2009-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2009-01-01 | 2010-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2010-01-01 | 2013-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2013-01-01 | 2020-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2020-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | MINDATE    | 2000-01-01 | Υ  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2000-01-01 | 2009-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2009-01-01 | 2010-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2010-01-01 | 2013-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2013-01-01 | 2020-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2020-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | MINDATE    | 2000-01-01 | Υ  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2000-01-01 | 2009-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2009-01-01 | 2010-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2010-01-01 | 2013-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2013-01-01 | 2020-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2020-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | MINDATE    | 2000-01-01 | Υ  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2000-01-01 | 2009-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2009-01-01 | 2010-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2010-01-01 | 2013-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2013-01-01 | 2020-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2020-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+


ΚΑΝΟΝΑΣ 8: Επέκταση του εισερχόμενου πίνακα
-------------------------------------------
Ο εισερχόμενος πίνακας επεκτείνεται με την εξής διαδικασία:

* Δημιουργείται ένα αντίγραφο του εισερχόμενου πίνακα.

* Αντικαθίσταται το `SRC_USR` με `AUTH` στο αντίγραφο και προστίθεται στον εισερχόμενο πίνακα.

* Αντικαθίσταται το `SRC_ORG` με `AUTH` στο αντίγραφο και προστίθεται στον εισερχόμενο πίνακα.

* Αντικαθίστανται και τα δύο, το `SRC_ORG` και το `SRC_USR`, με `AUTH` στο αντίγραφο και προστίθεται στον εισερχόμενο πίνακα.

+---------+---------+---------+------+------------+------------+----+------+
| SRC_TYP | SRC_ORG | SRC_USR | ID   | VLD_FRM    | VLD_T      | NM | SCTR |
+=========+=========+=========+======+============+============+====+======+
| CDR     | AUTH    | AUTH    | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | MINDATE    | 2000-01-01 |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2000-01-01 | 2009-01-01 | Z  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2010-01-01 | 2013-01-01 |    | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2013-01-01 | 2020-01-01 |    | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2020-01-01 | 2022-01-01 |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2025-01-01 | MAXDATE    |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | MINDATE    | 2000-01-01 |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2000-01-01 | 2009-01-01 | Z  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2010-01-01 | 2013-01-01 |    | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2013-01-01 | 2020-01-01 |    | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2020-01-01 | 2022-01-01 |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2025-01-01 | MAXDATE    |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | MINDATE    | 2000-01-01 |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2000-01-01 | 2009-01-01 | Z  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2010-01-01 | 2013-01-01 |    | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2013-01-01 | 2020-01-01 |    | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2020-01-01 | 2022-01-01 |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2025-01-01 | MAXDATE    |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | MINDATE    | 2000-01-01 |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2000-01-01 | 2009-01-01 | Z  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2010-01-01 | 2013-01-01 |    | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2013-01-01 | 2020-01-01 |    | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2020-01-01 | 2022-01-01 |    |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2025-01-01 | MAXDATE    |    |      |
+---------+---------+---------+------+------------+------------+----+------+


ΚΑΝΟΝΑΣ 9: Υπολογισμός των νέων εγγραφών για εισαγωγή στη DAT
-------------------------------------------------------------

Τα κενά στον εισερχόμενο πίνακα συμπληρώνονται από τον υφιστάμενο:

+---------+---------+---------+------+------------+------------+----+------+
| SRC_TYP | SRC_ORG | SRC_USR | ID   | VLD_FRM    | VLD_T      | NM | SCTR |
+=========+=========+=========+======+============+============+====+======+
| CDR     | AUTH    | AUTH    | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | MINDATE    | 2000-01-01 | Υ  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2000-01-01 | 2009-01-01 | Z  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2010-01-01 | 2013-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2013-01-01 | 2020-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2020-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | MINDATE    | 2000-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2000-01-01 | 2009-01-01 | Z  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2010-01-01 | 2013-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2013-01-01 | 2020-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2020-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | MINDATE    | 2000-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2000-01-01 | 2009-01-01 | Z  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2010-01-01 | 2013-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2013-01-01 | 2020-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2020-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | MINDATE    | 2000-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2000-01-01 | 2009-01-01 | Z  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2010-01-01 | 2013-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2013-01-01 | 2020-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2020-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+

Σε επίπεδο αναγνωριστικών κωδικών και μόνο στους REF πίνακες αν υπάρχει SRC_TYP πιο ισχυρό στα υφιστάμενα στοιχεία από τα εισερχόμενα τότε δεν αλλάζει το AUTH του SRC_TYP.  Στην αντίθετη περίπτωση δημιουργούνται νέες εγγραφές για το SRC_TYP=AUTH αντιγράφοντας τα σχετικά εισερχόμενα στοιχεία και θέτοντας SRC_TYP=AUTH κάτι που ισχύει και για το παράδειγμά μας και άρα έχουμε τον παρακάτω πίνακα ως υποψήφιο να μπει στη BED:

+---------+---------+---------+------+------------+------------+----+------+
| SRC_TYP | SRC_ORG | SRC_USR | ID   | VLD_FRM    | VLD_T      | NM | SCTR |
+=========+=========+=========+======+============+============+====+======+
| CDR     | AUTH    | AUTH    | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | MINDATE    | 2000-01-01 | Υ  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2000-01-01 | 2009-01-01 | Z  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2010-01-01 | 2013-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2013-01-01 | 2020-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2020-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | MINDATE    | 2000-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2000-01-01 | 2009-01-01 | Z  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2010-01-01 | 2013-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2013-01-01 | 2020-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2020-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | MINDATE    | 2000-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2000-01-01 | 2009-01-01 | Z  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2010-01-01 | 2013-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2013-01-01 | 2020-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2020-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | MINDATE    | 2000-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2000-01-01 | 2009-01-01 | Z  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2010-01-01 | 2013-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2013-01-01 | 2020-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2020-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | MINDATE    | 2000-01-01 | Υ  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | 2000-01-01 | 2009-01-01 | Z  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | 2010-01-01 | 2013-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | 2013-01-01 | 2020-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | 2020-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | MINDATE    | 2000-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | 2000-01-01 | 2009-01-01 | Z  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | 2010-01-01 | 2013-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | 2013-01-01 | 2020-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | 2020-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | MINDATE    | 2000-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | 2000-01-01 | 2009-01-01 | Z  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | 2010-01-01 | 2013-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | 2013-01-01 | 2020-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | 2020-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | MINDATE    | 2000-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | 2000-01-01 | 2009-01-01 | Z  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | 2010-01-01 | 2013-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | 2013-01-01 | 2020-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | 2020-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+


ΚΑΝΟΝΑΣ 10: Διαγραφή διπλοεγγραφών και αντικατάσταση τιμών αρχικοποίησης
------------------------------------------------------------------------
Αν υπάρχουν διπλοεγγραφές στο υποψήφια προς εισαγωγή στη BED ανά SRC και αναγνωριστικών κωδικών τότε διαγράφονται, αναπροσαρμόζονται αν χρειάζεται τα χρονικά διαστήματα και παραμένουν οι πιο πρόσφατες:  

+---------+---------+---------+------+------------+------------+----+------+
| SRC_TYP | SRC_ORG | SRC_USR | ID   | VLD_FRM    | VLD_T      | NM | SCTR |
+=========+=========+=========+======+============+============+====+======+
| CDR     | AUTH    | AUTH    | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | MINDATE    | 2000-01-01 | Υ  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2000-01-01 | 2009-01-01 | Z  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2010-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | AUTH    | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | MINDATE    | 2000-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2000-01-01 | 2009-01-01 | Z  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2010-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | AUTH    | auser   | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | MINDATE    | 2000-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2000-01-01 | 2009-01-01 | Z  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2010-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | AUTH    | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | MINDATE    | 2000-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2000-01-01 | 2009-01-01 | Z  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2010-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| CDR     | EGR0    | auser   | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | MINDATE    | 2000-01-01 | Υ  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | 2000-01-01 | 2009-01-01 | Z  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | 2010-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | AUTH    | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | MINDATE    | 2000-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | 2000-01-01 | 2009-01-01 | Z  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | 2010-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | AUTH    | auser   | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | MINDATE    | 2000-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | 2000-01-01 | 2009-01-01 | Z  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | 2010-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | AUTH    | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR1 | MINDATE    | 2000-01-01 | Α  |      |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR1 | 2000-01-01 | 2009-01-25 | Β  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR1 | 2009-01-25 | MAXDATE    | C  | S128 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | MINDATE    | 2000-01-01 | Y  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | 2000-01-01 | 2009-01-01 | Z  | S125 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | 2009-01-01 | 2010-01-01 | Z  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | 2010-01-01 | 2022-01-01 | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | 2022-01-01 | 2025-01-01 | Y  | S122 |
+---------+---------+---------+------+------------+------------+----+------+
| AUTH    | EGR0    | auser   | EGR2 | 2025-01-01 | MAXDATE    | Y  | S127 |
+---------+---------+---------+------+------------+------------+----+------+

Σε περίπτωση που στα measures ή στα attributes υπάρχει η τιμή της αρχικοποίησης
αντικαθίσταται με την αρχική τιμή της βάσης δεδομενων.


ΚΑΝΟΝΑΣ 11: Σύγκριση με τα υφιστάμενα στοιχεία της βάσης και εισαγωγή αν υπάρχουν διαφορές
------------------------------------------------------------------------------------------

Τα υπό ένταξει στοιχεία στη BED συγκρίνονται με τα αρχικά υφιστάμενα σε επίπεδο SRC και αναγνωριστικού κωδικού (αναγνωριστικών κωδικών) και αν υπάρχουν διαφορές τα νέα στοιχεία εισάγονται στη βάση αφού τους προστεθεί το TIMESTAMP.
